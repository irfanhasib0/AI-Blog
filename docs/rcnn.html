<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_qptiuu6mlbhu-0{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-1{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-2{list-style-type:none}.lst-kix_4rhwz7ggv80b-2>li:before{content:"-  "}.lst-kix_4rhwz7ggv80b-3>li:before{content:"-  "}ul.lst-kix_qptiuu6mlbhu-7{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-8{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-3{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-4{list-style-type:none}ul.lst-kix_qptiuu6mlbhu-5{list-style-type:none}.lst-kix_4rhwz7ggv80b-1>li:before{content:"-  "}ul.lst-kix_qptiuu6mlbhu-6{list-style-type:none}.lst-kix_4rhwz7ggv80b-0>li:before{content:"-  "}ol.lst-kix_ok5xa7eenesj-7.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-7 0}.lst-kix_ok5xa7eenesj-5>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-5}.lst-kix_b2x7vhnewr2g-1>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-1}.lst-kix_e4jv1uqp760x-6>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-6,decimal) ". "}.lst-kix_e4jv1uqp760x-7>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-7,lower-latin) ". "}ul.lst-kix_4rhwz7ggv80b-2{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-5.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-5 0}ul.lst-kix_4rhwz7ggv80b-1{list-style-type:none}.lst-kix_e4jv1uqp760x-3>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-3,decimal) ". "}ul.lst-kix_4rhwz7ggv80b-0{list-style-type:none}ol.lst-kix_e4jv1uqp760x-4.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-4 0}.lst-kix_e4jv1uqp760x-4>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-4,lower-latin) ". "}.lst-kix_e4jv1uqp760x-5>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-5,lower-roman) ". "}.lst-kix_4rhwz7ggv80b-4>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-0>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-0,decimal) ". "}.lst-kix_4rhwz7ggv80b-5>li:before{content:"-  "}.lst-kix_4rhwz7ggv80b-8>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-2>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-2,lower-roman) ". "}.lst-kix_4rhwz7ggv80b-6>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-1>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-1,lower-latin) ". "}.lst-kix_4rhwz7ggv80b-7>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-8>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-8}.lst-kix_kwwyqny7ndcx-6>li:before{content:"-  "}ol.lst-kix_b2x7vhnewr2g-6.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-6 0}ol.lst-kix_e4jv1uqp760x-3.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-3 0}.lst-kix_ok5xa7eenesj-1>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-1}.lst-kix_kwwyqny7ndcx-3>li:before{content:"-  "}.lst-kix_kwwyqny7ndcx-7>li:before{content:"-  "}.lst-kix_b2x7vhnewr2g-8>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-8}.lst-kix_kwwyqny7ndcx-4>li:before{content:"-  "}.lst-kix_kwwyqny7ndcx-5>li:before{content:"-  "}ol.lst-kix_b2x7vhnewr2g-1{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-2{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-0{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-5{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-6{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-3{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-4{list-style-type:none}ol.lst-kix_eg1j27aju83u-0.start{counter-reset:lst-ctn-kix_eg1j27aju83u-0 0}ol.lst-kix_b2x7vhnewr2g-7{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-8{list-style-type:none}.lst-kix_kwwyqny7ndcx-8>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-8>li:before{content:"" counter(lst-ctn-kix_e4jv1uqp760x-8,lower-roman) ". "}ol.lst-kix_eg1j27aju83u-5.start{counter-reset:lst-ctn-kix_eg1j27aju83u-5 0}ol.lst-kix_b2x7vhnewr2g-0.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-0 0}.lst-kix_e4jv1uqp760x-6>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-6}.lst-kix_eg1j27aju83u-7>li{counter-increment:lst-ctn-kix_eg1j27aju83u-7}ul.lst-kix_npk1gp2e3on-0{list-style-type:none}ul.lst-kix_npk1gp2e3on-1{list-style-type:none}ul.lst-kix_npk1gp2e3on-2{list-style-type:none}.lst-kix_kwwyqny7ndcx-2>li:before{content:"-  "}ul.lst-kix_npk1gp2e3on-7{list-style-type:none}ul.lst-kix_npk1gp2e3on-8{list-style-type:none}.lst-kix_kwwyqny7ndcx-0>li:before{content:"-  "}ul.lst-kix_npk1gp2e3on-3{list-style-type:none}ul.lst-kix_npk1gp2e3on-4{list-style-type:none}.lst-kix_kwwyqny7ndcx-1>li:before{content:"-  "}ul.lst-kix_npk1gp2e3on-5{list-style-type:none}ul.lst-kix_npk1gp2e3on-6{list-style-type:none}.lst-kix_ukzohec7w29a-8>li:before{content:"-  "}ol.lst-kix_eg1j27aju83u-6.start{counter-reset:lst-ctn-kix_eg1j27aju83u-6 0}ol.lst-kix_e4jv1uqp760x-8.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-8 0}.lst-kix_b2x7vhnewr2g-5>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-5}ol.lst-kix_ok5xa7eenesj-0.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-0 0}.lst-kix_ukzohec7w29a-4>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-7>li:before{content:"-  "}ol.lst-kix_eg1j27aju83u-0{list-style-type:none}ol.lst-kix_eg1j27aju83u-1{list-style-type:none}ol.lst-kix_eg1j27aju83u-2{list-style-type:none}ol.lst-kix_eg1j27aju83u-3{list-style-type:none}.lst-kix_e4jv1uqp760x-3>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-3}.lst-kix_eg1j27aju83u-0>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-0,decimal) ". "}ol.lst-kix_eg1j27aju83u-4{list-style-type:none}ol.lst-kix_eg1j27aju83u-5{list-style-type:none}ol.lst-kix_eg1j27aju83u-6{list-style-type:none}.lst-kix_ukzohec7w29a-6>li:before{content:"-  "}ol.lst-kix_eg1j27aju83u-7{list-style-type:none}ol.lst-kix_eg1j27aju83u-8{list-style-type:none}ul.lst-kix_sogmjv37c5jb-3{list-style-type:none}ul.lst-kix_sogmjv37c5jb-4{list-style-type:none}.lst-kix_ok5xa7eenesj-5>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-5,lower-roman) ". "}ul.lst-kix_sogmjv37c5jb-1{list-style-type:none}ul.lst-kix_sogmjv37c5jb-2{list-style-type:none}.lst-kix_qptiuu6mlbhu-7>li:before{content:"-  "}ul.lst-kix_sogmjv37c5jb-0{list-style-type:none}.lst-kix_ok5xa7eenesj-3>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-3,decimal) ". "}.lst-kix_ok5xa7eenesj-7>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-7,lower-latin) ". "}ol.lst-kix_ok5xa7eenesj-3.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-3 0}.lst-kix_eg1j27aju83u-2>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-2,lower-roman) ". "}.lst-kix_eg1j27aju83u-4>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-4,lower-latin) ". "}.lst-kix_eg1j27aju83u-6>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-6,decimal) ". "}.lst-kix_eg1j27aju83u-0>li{counter-increment:lst-ctn-kix_eg1j27aju83u-0}.lst-kix_b2x7vhnewr2g-3>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-3}ul.lst-kix_3hdjefme7cz8-5{list-style-type:none}ul.lst-kix_3hdjefme7cz8-6{list-style-type:none}.lst-kix_ok5xa7eenesj-1>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-1,lower-latin) ". "}ul.lst-kix_3hdjefme7cz8-3{list-style-type:none}ul.lst-kix_3hdjefme7cz8-4{list-style-type:none}.lst-kix_eg1j27aju83u-8>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-8,lower-roman) ". "}ul.lst-kix_3hdjefme7cz8-7{list-style-type:none}ul.lst-kix_3hdjefme7cz8-8{list-style-type:none}ul.lst-kix_ukzohec7w29a-2{list-style-type:none}ul.lst-kix_ukzohec7w29a-3{list-style-type:none}ul.lst-kix_ukzohec7w29a-4{list-style-type:none}ul.lst-kix_ukzohec7w29a-5{list-style-type:none}.lst-kix_eg1j27aju83u-5>li{counter-increment:lst-ctn-kix_eg1j27aju83u-5}ul.lst-kix_ukzohec7w29a-6{list-style-type:none}ul.lst-kix_3hdjefme7cz8-1{list-style-type:none}ul.lst-kix_ukzohec7w29a-7{list-style-type:none}ul.lst-kix_3hdjefme7cz8-2{list-style-type:none}ul.lst-kix_ukzohec7w29a-8{list-style-type:none}ul.lst-kix_3hdjefme7cz8-0{list-style-type:none}ol.lst-kix_e4jv1uqp760x-6{list-style-type:none}ol.lst-kix_e4jv1uqp760x-7{list-style-type:none}ol.lst-kix_e4jv1uqp760x-6.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-6 0}ol.lst-kix_e4jv1uqp760x-8{list-style-type:none}ol.lst-kix_e4jv1uqp760x-2{list-style-type:none}.lst-kix_qptiuu6mlbhu-3>li:before{content:"-  "}ol.lst-kix_e4jv1uqp760x-3{list-style-type:none}ol.lst-kix_e4jv1uqp760x-4{list-style-type:none}ol.lst-kix_e4jv1uqp760x-5{list-style-type:none}ol.lst-kix_eg1j27aju83u-8.start{counter-reset:lst-ctn-kix_eg1j27aju83u-8 0}.lst-kix_qptiuu6mlbhu-5>li:before{content:"-  "}ul.lst-kix_sogmjv37c5jb-7{list-style-type:none}ul.lst-kix_sogmjv37c5jb-8{list-style-type:none}ol.lst-kix_ok5xa7eenesj-2.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-2 0}ul.lst-kix_sogmjv37c5jb-5{list-style-type:none}ul.lst-kix_sogmjv37c5jb-6{list-style-type:none}.lst-kix_b2x7vhnewr2g-4>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-4}.lst-kix_3hdjefme7cz8-3>li:before{content:"-  "}.lst-kix_npk1gp2e3on-6>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-5>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-4>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-4}ul.lst-kix_kwwyqny7ndcx-1{list-style-type:none}.lst-kix_qptiuu6mlbhu-1>li:before{content:"-  "}ul.lst-kix_kwwyqny7ndcx-2{list-style-type:none}.lst-kix_npk1gp2e3on-4>li:before{content:"-  "}ul.lst-kix_kwwyqny7ndcx-3{list-style-type:none}ul.lst-kix_kwwyqny7ndcx-4{list-style-type:none}.lst-kix_ok5xa7eenesj-3>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-3}ol.lst-kix_e4jv1uqp760x-5.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-5 0}ul.lst-kix_kwwyqny7ndcx-0{list-style-type:none}ol.lst-kix_ok5xa7eenesj-1.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-1 0}.lst-kix_npk1gp2e3on-0>li:before{content:"-  "}ul.lst-kix_kwwyqny7ndcx-5{list-style-type:none}ul.lst-kix_kwwyqny7ndcx-6{list-style-type:none}.lst-kix_npk1gp2e3on-2>li:before{content:"-  "}ul.lst-kix_kwwyqny7ndcx-7{list-style-type:none}.lst-kix_3hdjefme7cz8-1>li:before{content:"-  "}ul.lst-kix_kwwyqny7ndcx-8{list-style-type:none}.lst-kix_sogmjv37c5jb-5>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-6>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-3>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-7>li:before{content:"-  "}.lst-kix_ok5xa7eenesj-4>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-4}.lst-kix_eg1j27aju83u-8>li{counter-increment:lst-ctn-kix_eg1j27aju83u-8}.lst-kix_sogmjv37c5jb-1>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-2>li:before{content:"-  "}.lst-kix_b2x7vhnewr2g-0>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-0}.lst-kix_sogmjv37c5jb-0>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-8>li:before{content:"-  "}ol.lst-kix_ok5xa7eenesj-4.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-4 0}.lst-kix_e4jv1uqp760x-7>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-7}ol.lst-kix_eg1j27aju83u-2.start{counter-reset:lst-ctn-kix_eg1j27aju83u-2 0}ol.lst-kix_e4jv1uqp760x-1.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-1 0}.lst-kix_npk1gp2e3on-8>li:before{content:"-  "}.lst-kix_sogmjv37c5jb-4>li:before{content:"-  "}.lst-kix_b2x7vhnewr2g-7>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-7,lower-latin) ". "}.lst-kix_b2x7vhnewr2g-5>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-5,lower-roman) ". "}.lst-kix_b2x7vhnewr2g-6>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-6,decimal) ". "}ol.lst-kix_e4jv1uqp760x-7.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-7 0}ol.lst-kix_e4jv1uqp760x-0{list-style-type:none}ol.lst-kix_e4jv1uqp760x-1{list-style-type:none}.lst-kix_b2x7vhnewr2g-4>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-4,lower-latin) ". "}ol.lst-kix_eg1j27aju83u-7.start{counter-reset:lst-ctn-kix_eg1j27aju83u-7 0}.lst-kix_b2x7vhnewr2g-1>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-1,lower-latin) ". "}.lst-kix_b2x7vhnewr2g-2>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-2,lower-roman) ". "}.lst-kix_b2x7vhnewr2g-3>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-3,decimal) ". "}ol.lst-kix_b2x7vhnewr2g-8.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-8 0}.lst-kix_e4jv1uqp760x-5>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-5}.lst-kix_b2x7vhnewr2g-0>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-0,decimal) ". "}ul.lst-kix_ukzohec7w29a-0{list-style-type:none}ul.lst-kix_ukzohec7w29a-1{list-style-type:none}.lst-kix_eg1j27aju83u-6>li{counter-increment:lst-ctn-kix_eg1j27aju83u-6}.lst-kix_b2x7vhnewr2g-2>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-2}.lst-kix_eg1j27aju83u-4>li{counter-increment:lst-ctn-kix_eg1j27aju83u-4}ol.lst-kix_ok5xa7eenesj-5.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-5 0}.lst-kix_e4jv1uqp760x-0>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-0}.lst-kix_ok5xa7eenesj-8>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-8,lower-roman) ". "}.lst-kix_b2x7vhnewr2g-8>li:before{content:"" counter(lst-ctn-kix_b2x7vhnewr2g-8,lower-roman) ". "}.lst-kix_ok5xa7eenesj-2>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-2}ol.lst-kix_b2x7vhnewr2g-7.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-7 0}ol.lst-kix_e4jv1uqp760x-2.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-2 0}.lst-kix_ok5xa7eenesj-8>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-8}.lst-kix_ukzohec7w29a-1>li:before{content:"-  "}.lst-kix_ukzohec7w29a-2>li:before{content:"-  "}.lst-kix_ukzohec7w29a-0>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-2>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-2}.lst-kix_eg1j27aju83u-2>li{counter-increment:lst-ctn-kix_eg1j27aju83u-2}ol.lst-kix_b2x7vhnewr2g-1.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-1 0}.lst-kix_ukzohec7w29a-3>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-8>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-6>li:before{content:"-  "}ol.lst-kix_b2x7vhnewr2g-4.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-4 0}.lst-kix_eg1j27aju83u-1>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-1,lower-latin) ". "}.lst-kix_ukzohec7w29a-7>li:before{content:"-  "}.lst-kix_eg1j27aju83u-1>li{counter-increment:lst-ctn-kix_eg1j27aju83u-1}.lst-kix_ukzohec7w29a-5>li:before{content:"-  "}.lst-kix_ok5xa7eenesj-4>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-4,lower-latin) ". "}.lst-kix_qptiuu6mlbhu-8>li:before{content:"-  "}.lst-kix_ok5xa7eenesj-2>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-2,lower-roman) ". "}.lst-kix_ok5xa7eenesj-6>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-6,decimal) ". "}.lst-kix_eg1j27aju83u-3>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-3,decimal) ". "}ol.lst-kix_ok5xa7eenesj-8{list-style-type:none}.lst-kix_b2x7vhnewr2g-6>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-6}ol.lst-kix_ok5xa7eenesj-5{list-style-type:none}ol.lst-kix_eg1j27aju83u-1.start{counter-reset:lst-ctn-kix_eg1j27aju83u-1 0}.lst-kix_eg1j27aju83u-3>li{counter-increment:lst-ctn-kix_eg1j27aju83u-3}ol.lst-kix_ok5xa7eenesj-4{list-style-type:none}ol.lst-kix_e4jv1uqp760x-0.start{counter-reset:lst-ctn-kix_e4jv1uqp760x-0 0}ol.lst-kix_ok5xa7eenesj-7{list-style-type:none}ol.lst-kix_ok5xa7eenesj-6{list-style-type:none}.lst-kix_eg1j27aju83u-5>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-5,lower-roman) ". "}.lst-kix_ok5xa7eenesj-0>li:before{content:"" counter(lst-ctn-kix_ok5xa7eenesj-0,decimal) ". "}.lst-kix_ok5xa7eenesj-7>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-7}ol.lst-kix_ok5xa7eenesj-6.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-6 0}.lst-kix_eg1j27aju83u-7>li:before{content:"" counter(lst-ctn-kix_eg1j27aju83u-7,lower-latin) ". "}ol.lst-kix_eg1j27aju83u-4.start{counter-reset:lst-ctn-kix_eg1j27aju83u-4 0}ol.lst-kix_ok5xa7eenesj-1{list-style-type:none}ol.lst-kix_ok5xa7eenesj-0{list-style-type:none}ol.lst-kix_ok5xa7eenesj-3{list-style-type:none}ol.lst-kix_ok5xa7eenesj-2{list-style-type:none}.lst-kix_qptiuu6mlbhu-2>li:before{content:"-  "}ul.lst-kix_4rhwz7ggv80b-8{list-style-type:none}ul.lst-kix_4rhwz7ggv80b-7{list-style-type:none}ul.lst-kix_4rhwz7ggv80b-6{list-style-type:none}.lst-kix_qptiuu6mlbhu-4>li:before{content:"-  "}ul.lst-kix_4rhwz7ggv80b-5{list-style-type:none}ul.lst-kix_4rhwz7ggv80b-4{list-style-type:none}ul.lst-kix_4rhwz7ggv80b-3{list-style-type:none}ol.lst-kix_b2x7vhnewr2g-2.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-2 0}.lst-kix_qptiuu6mlbhu-6>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-0>li:before{content:"-  "}.lst-kix_3hdjefme7cz8-2>li:before{content:"-  "}.lst-kix_b2x7vhnewr2g-7>li{counter-increment:lst-ctn-kix_b2x7vhnewr2g-7}.lst-kix_3hdjefme7cz8-4>li:before{content:"-  "}.lst-kix_npk1gp2e3on-7>li:before{content:"-  "}ol.lst-kix_eg1j27aju83u-3.start{counter-reset:lst-ctn-kix_eg1j27aju83u-3 0}ol.lst-kix_ok5xa7eenesj-8.start{counter-reset:lst-ctn-kix_ok5xa7eenesj-8 0}.lst-kix_npk1gp2e3on-5>li:before{content:"-  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_ok5xa7eenesj-6>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-6}.lst-kix_npk1gp2e3on-3>li:before{content:"-  "}.lst-kix_e4jv1uqp760x-1>li{counter-increment:lst-ctn-kix_e4jv1uqp760x-1}.lst-kix_qptiuu6mlbhu-0>li:before{content:"-  "}.lst-kix_ok5xa7eenesj-0>li{counter-increment:lst-ctn-kix_ok5xa7eenesj-0}.lst-kix_npk1gp2e3on-1>li:before{content:"-  "}ol.lst-kix_b2x7vhnewr2g-3.start{counter-reset:lst-ctn-kix_b2x7vhnewr2g-3 0}ol{margin:0;padding:0}table td,table th{padding:0}.c7{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c5{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c2{color:#666666;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:italic}.c25{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c21{color:#666666;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Times New Roman"}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c11{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c12{color:#000000;text-decoration:none;vertical-align:baseline;font-style:italic}.c10{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.c1{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c4{font-size:12pt;font-family:"Times New Roman";font-weight:700}.c32{background-color:#ffffff;max-width:648pt;padding:72pt 72pt 72pt 72pt}.c24{color:#333333;text-decoration:none;vertical-align:baseline}.c22{color:#000000;text-decoration:none;font-style:normal}.c0{font-size:12pt;font-family:"Times New Roman";font-weight:400}.c23{color:#666666;text-decoration:none;vertical-align:baseline}.c31{font-weight:700;font-size:16pt;font-family:"Times New Roman"}.c29{text-decoration:none;vertical-align:baseline;font-style:normal}.c15{font-weight:700;font-size:14pt;font-family:"Times New Roman"}.c13{font-weight:700;font-size:15pt;font-family:"Times New Roman"}.c30{font-weight:400;font-size:11pt;font-family:"Arial"}.c27{font-weight:400;font-family:"Times New Roman"}.c20{margin-left:72pt;padding-left:0pt}.c3{color:inherit;text-decoration:inherit}.c18{background-color:#ffffff;color:#202124}.c17{padding:0;margin:0}.c16{font-style:italic}.c28{margin-left:36pt}.c19{color:#67ab9f}.c8{vertical-align:sub}.c26{color:#202124}.c14{vertical-align:super}.c9{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c32 doc-content"><p class="c11"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">&nbsp; &nbsp; &nbsp;</span><span class="c1 c31">&nbsp; Object Detection : The RCNN Family </span></p><hr><p class="c6 c9"><span class="c2"></span></p><p class="c6"><span class="c16 c21">&nbsp; November 06, 2022</span></p><p class="c6"><span class="c1 c4">&nbsp;</span></p><p class="c6"><span class="c4 c16">Object Detection</span><span class="c1 c0">&nbsp;is the combination of two sub tasks (i) Object Localization (ii) Object Classification. These two steps comprise the simplest intuitive way, firstly we localize the object in the image and then classify it to an object category. When it comes to object detection with deep learning, we need to consider an additional step &lsquo;Feature Extraction&rsquo;. It breaks down the raw data into a high dimensional feature space, which is more convenient for the computer to work with.</span></p><p class="c6"><span class="c4">[A]</span><span class="c0">&nbsp;</span><span class="c4">Object localization :</span><span class="c1 c0">&nbsp;This step takes the rgb image and extracts the N set of (x,y,w,h) bounding box coordinates for potential objects present in it. It can be done in two ways (i) using some specific image processing based algorithm e.g Selective search, (ii) using convolutional neural network e.g Region Proposal Network used in Faster RCNN algorithm.</span></p><p class="c6"><span class="c4">[B]</span><span class="c0">&nbsp;</span><span class="c4">Feature map Extraction :</span><span class="c1 c0">&nbsp;It takes an image array and converts it to a high dimensional feature map array using a convolutional layer based neural network e.g VGG16, ResNet 50 etc.</span></p><p class="c6"><span class="c4">[C]</span><span class="c0">&nbsp;</span><span class="c4">Classification :</span><span class="c1 c0">&nbsp;This step takes each of the extracted feature maps and classifies it to an object category using dense layers or some machine learning &nbsp;based classifier algorithm e.g SVM (support vector machine). </span></p><p class="c6"><span class="c1 c0">Note : [A], [B] and [C] are used for denoting these 3 steps in the upcoming sections.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Table of Contents : </span></p><ol class="c17 lst-kix_ok5xa7eenesj-0 start" start="1"><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.84vusytwcdqy">RCNN</a></span></li><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.l15avbdo0ozv">Fast RCNN</a></span></li><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.ph21n9qz9a23">Faster RCNN</a></span></li><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.5vr554v50nm8">Mask RCNN</a></span></li><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.ux9wfpfe9xxw">Symbols &amp; Short Forms</a></span><span class="c1 c30">, </span></li><li class="c5 li-bullet-0"><span class="c10 c0"><a class="c3" href="#id.5wa040rdg73v">Appendix </a></span><span class="c0">, </span><span class="c10 c0"><a class="c3" href="#id.yjsz3yu24x1v">References &amp; Git Repos.</a></span><span class="c0">, </span></li></ol><a id="id.84vusytwcdqy"></a><p class="c6"><span class="c12 c15">RCNN</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">The RCNN method uses following modules to perform object detection :</span></p><p class="c6"><span class="c4">Selective Search &nbsp;:</span><span class="c1 c0">&nbsp;It is an algorithm for generating region proposal suggestions. It suggests potential bboxes (bounding boxes) that may contain an object. &#39;Objectness&#39; is another similar algorithm that can be used for region proposal generation. SOTA works now use a simple CNN based architecture called RPN (region proposal network) for this purpose. See the appendix at the bottom for more about selective search. </span></p><p class="c6"><span class="c4">Feature Extractor (FE) : &nbsp;</span><span class="c1 c0">It can be any deep convolutional neural network. The output of the network is truncated from the last dense layer (if a 1d feature vector is necessary) or any of the intermediate convolutional layers (if a 2 dimensional feature map is required). The 2d featuremap also preserves the spatial relationship with the input image due to the sliding nature of convolution operation. &nbsp;For RCNN they don&#39;t require the spatial relation, so use the output of a dense layer as a 1d feature vector. For fast RCNN it will need a 2d feature map instead.</span></p><p class="c6"><span class="c4">Binary SVM :</span><span class="c1 c0">&nbsp;Support vector machine algorithm is used for binary (yes/no) classification every single class. Binary SVM is specially suited for single class classification since it tries to select the hyperplane that separates the two classes with highest margin.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 753.91px; height: 634.17px;"><img alt="" src="files/rcnn/image13.png" style="width: 753.91px; height: 634.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">Figure : RCNN (top) and Fast RCNN (bottom)</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c12 c4">RCNN Algorithm :</span></p><p class="c6"><span class="c1 c0">1. [A] Selective Search algorithm is used for generating ~ 2000 sets of bounding box coordinate (x,y,w,h) proposals per image. Using the bbox coordinates found from selective search, image RoIs (Region of Interest) of different sizes are cropped. For detail on it see the appendix at the bottom.</span></p><p class="c6"><span class="c1 c0">2. [A] The SVM classifier can only take fixed sized inputs. So the outputs of the feature extractor should have constant size. It is possible if the input image RoIs to the feature extractor have fixed size. For this reason each RoI is &#39;warped&#39; to a fixed size [resizing with bilinear/nearest sampling] before inputting them to the feature extractor model. </span></p><p class="c6"><span class="c1 c0">3. [B] A deep convolutional neural network is used for extracting feature maps from each of the image RoI one by one. The model output is truncated from the bottom and output from a dense layer with 4096 nodes is extracted as a feature map.</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; Pre training with ICSLV-2012 images with 200 classes lr 0.01 on CNN architecture by krizhevsky at el. 2012.</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; Oversampling positive classes 32 positive sample + 96 neg sample per mini-batch</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; Fine tuning with lr 0.001 with wrapped region proposal with N + 1 class. N is no of object class 1 is background</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; During fine tuning a region proposal with more than 0.50 IoU with a positive sample was taken as positive.</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; During Feature Extraction the last layer is removed and features from an internal dense layer are collected. i.e 1024 or 2048 features</span></p><p class="c6"><span class="c1 c0">4. [C] &nbsp;Separate binary classifiers for each of the N (N=no of categories) are trained to categorize the fmaps to respective object categories.</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; One binary SVM classifier is used for each of the classes.</span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; Hard negative mining [4] is found to be useful for fast convergence. For detail see right section.</span></p><p class="c6"><span class="c1 c0">5. [A*] Fine tuning of the localization boxes are done by bbox regression using Ridge regression with lambda = 1000. The regressor only learns the x,y offset from the corner of the bbox predicted by selective search. For w,h it is log offset instead. The next section will explain it in detail.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c4">BBOX Regression : </span></p><p class="c11"><span class="c1 c0">This approach was Inspired from the Deformable part model by Girshick at el. 2010. Let&rsquo;s assume the following -</span></p><ul class="c17 lst-kix_npk1gp2e3on-0 start"><li class="c7 li-bullet-0"><span class="c1 c0">X,y are the coordinates of a bbox in an image and w, h are its width and height respectively</span></li></ul><ul class="c17 lst-kix_qptiuu6mlbhu-0 start"><li class="c7 li-bullet-0"><span class="c0">The initial bbox predictions are P = &nbsp;[P</span><span class="c0 c8">x</span><span class="c0">,P</span><span class="c0 c8">y</span><span class="c0">,P</span><span class="c0 c8">w</span><span class="c0">,P</span><span class="c0 c8">h</span><span class="c1 c0">]</span></li><li class="c7 li-bullet-0"><span class="c0">The initial bbox ground truths are G = [G</span><span class="c0 c8">x</span><span class="c0">,G</span><span class="c0 c8">y</span><span class="c0">,G</span><span class="c0 c8">w</span><span class="c0">,G</span><span class="c0 c8">h</span><span class="c1 c0">]</span></li><li class="c7 li-bullet-0"><span class="c0">d</span><span class="c0 c8">x</span><span class="c0">(P) , d</span><span class="c0 c8">y</span><span class="c0">(P), d</span><span class="c0 c8">w</span><span class="c0">(P), d</span><span class="c0 c8">h</span><span class="c1 c0">(P) is the output of regression i.e the errors/offsets to be corrected on P for matching with G more accurately.</span></li></ul><p class="c11"><span class="c0">For x and y, a &ldquo;scale invariant&rdquo; transformation d</span><span class="c0 c8">x</span><span class="c0">(P) d</span><span class="c0 c8">y</span><span class="c1 c0">(P) is learnt. They are positional offset corrections from an initial less accurate prediction by selective search. The offset (box placement error) value can vary within a wide range based on the size of the bbox. Big boxes can require a large offset while for small boxes it would be the opposite. The regressor output dx,dy are scale invariant offset, so the regressor can learn offset values for a fixed unit box (or unit scale i.e ranging from 0-1) for all the bbox and later need to be multiplied with the respective predicted size (Pw , Ph) of the bbox before adding to the prediction box i.e &nbsp;Gx = Pw * dx(P) + Px. For w and h a log scale transformation is learnt. It makes it capable of learning a wide range of change in w and h direction. Unlike x,y offsets, here it is just the difference of their logarithmic value instead of their actual value (eq [5] below).</span></p><p class="c11"><span class="c0">&nbsp;Most of the SOTA methods use an updated version of the bbox regression method introduced in RCNN. For example yolo-v3 uses &nbsp;G</span><span class="c0 c8">x</span><span class="c0">&nbsp;= Sigmoid(P) +P</span><span class="c0 c8">x </span><span class="c0">. They wrap the d</span><span class="c0 c8">x &nbsp;</span><span class="c1 c0">with a sigmoid function to restrict its output between 0-1. Some methods use a fixed grid system with a potential bbox at every location of the featuremap as an initial bbox then corrects it with regression. We will explain about these in detail in respective sections.</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 742.50px; height: 392.98px;"><img alt="" src="files/rcnn/image6.png" style="width: 742.50px; height: 392.98px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">As per our today&#39;s practice on SOTA object detection algorithms several things might seem to be redundant -</span></p><p class="c6"><span class="c1 c0">[i] Extracting feature maps for every RoI one by one. [It is solved in Fast RCNN eventually]</span></p><p class="c6"><span class="c1 c0">[ii] Using a separate SVM for each class instead of using the softmax class outputs of the feature extractor network. [Improved in Fast RCNN]</span></p><p class="c6"><span class="c1 c0">[iii] The word &quot;wrapped&quot; image is used in the paper for resizing each Fmap RoI to a fixed size. Nowadays a good practice is using bilinear sampling. Note that - rcnn first resizes (wrapped) each of the image RoI then inputs them to Feature extractor but Fast RCNN will resize the feature maps using RoI pooling layer.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">&nbsp;Using additional SVM classifier instead of the dense layer output from the feature extractor network :</span></p><p class="c6"><span class="c1 c0">Quote from the paper&#39;s appendix B : &quot;We tried this and found that performance on VOC 2007 dropped from 54.2% to 50.9% mAP. This performance drop likely arises from a combination of several factors including that the definition of positive examples used in fine-tuning does not emphasize precise localization and the softmax classi- fier was trained on randomly sampled negative examples rather than on the subset of &ldquo;hard negatives&rdquo; used for SVM training.&quot;</span></p><p class="c6"><span class="c1 c0">Anyway, in Fast RCNN the authors were finally able to do it using a small dense network after the feature extractor, without any SVM classifier.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c4">Hard Negative Mining :</span><span class="c1 c0">&nbsp; It is an approach that oversamples the difficult or hard to learn images more and makes the learning faster. It was possible to achieve good accuracy after just one pass over the data using hard negative mining for the SVM models.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><a id="id.l15avbdo0ozv"></a><p class="c6"><span class="c15 c16 c24">Fast RCNN</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6 c9"><span class="c4 c24 c16"></span></p><p class="c6"><span class="c1 c4">Improvements in Fast RCNN:</span></p><p class="c6"><span class="c1 c0">- Fast RCNN eliminated one by one RoI input into the feature extractor. There are lots of common regions between RoI&#39;s specially when nearly 2000 RoI generated from one image. This method applies a feature extractor for the whole image just once and then it crops the corresponding RoI for each of the ~ 2000 corresponding regions from the feature map. </span></p><p class="c6"><span class="c1 c0">- Replacing image wrapping with RoI Pooling.</span></p><p class="c6"><span class="c1 c0">- Getting rid of per class svm by using the softmax outputs from dense layers after feature extractor.</span></p><p class="c6 c9"><span class="c4 c19 c29"></span></p><p class="c6"><span class="c4 c19">&nbsp;</span><span class="c1 c4">Fast RCNN Algorithm :</span></p><p class="c6"><span class="c1 c0">1.[A] Selective Search generates ~ 2k RoI proposals per image. </span></p><p class="c6"><span class="c1 c0">2.[B] A CNN based network i.e VGG16 is used for feature extraction.</span></p><p class="c6"><span class="c1 c0">3.[B] The last max pool layer is replaced with a RoI Pooling layer for extracting fixed sized feature maps RoIs so that it can fit into the dense layer afterwards. (H=7, W=7 for VGG 16) </span></p><p class="c6"><span class="c0">4. [C] The last fully connected layer is replaced with 2 sibling dense layers (i) one &nbsp;for classification (ii) another for bbox regression. For regression it adopted the same fine tuning mechanism (optimizing t</span><span class="c0 c8">x</span><span class="c0">,t</span><span class="c0 c8">x</span><span class="c0">,t</span><span class="c0 c8">x</span><span class="c0">,t</span><span class="c0 c8">x</span><span class="c1 c0">) like RCNN. </span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c12 c4">RoI Pooling Layer</span></p><p class="c11"><span class="c1 c0">RoI Pooling Layer : The &nbsp;operator [*] represents the flooring operation here. e.g [1.13] = 1.00</span></p><p class="c11"><span class="c1 c0">The RoI pooling layer projects the image RoI on the feature map dimension by dividing each of the (x,y,w,h) coordinates with suitable factors (here it is 16 in below example). Then it does a max-pooling operation where the window size of the max pool is decided from the input size dynamically so that the output comes as a fixed size for any input RoI. For example 2 RoI with 15x15 and 10x10 can result in a fixed size RoI after max pool if the pooling window is selected &nbsp;3x3 and 2x2 respectively.</span></p><p class="c11"><span class="c1 c0">Below it is discussed in greater detail.</span></p><p class="c11"><span class="c4">[1] Scaling the image RoIs to fmap dimension : </span><span class="c1 c0">Due to multiple polling operations in the consecutive convolutional layers, the feature map array has smaller (e.g 16~32 times smaller) width and height compared to the original image. In the example below the feat map is 16 times smaller than the original image in terms of width and height. The RoI Pooling layer scales down each of the RoI coordinates (generated at the image scale) so that it fits on top of the feature map in the corresponding feature location. This is done by dividing each of the (x,y,w,h) with the scale factor (which is 16 here). In this way the 188x188 RoI window coordinates are converted to 11x11 below. Of course the center coordinates (x,y) of the RoI is also divided by the factor like (w,h) which is not shown in the figure for brevity.</span></p><p class="c11 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c4">[2] Resizing the Fmap RoI to fit the fixed input of dense layers :</span><span class="c1 c0">&nbsp;The dense layer has fixed input size i.e 25 dense nodes. If a 5x5x1 feature map tensor is flattened (5x5x1=25) only then it will fit the dense input. For 5x5x10 the dense should have 250 input nodes. For each of the RoI Feature maps do a maxpool operation with a kernel size calculated as ([h/h&#39;&#39;], [w/w&#39;&#39;]) to keep the output size fixed (h&rdquo;xw&rdquo;). For the example below it will be as follows &nbsp;- ([11/5],[11/5]) = (2,2). Now an arbitrary feature map of size 11x11 is operated with a maxpool of kernel size 2 for fitting fixed 5x5 input size of the dense layers afterward. Another example can be like - an orbitary Fmap RoI of size 20x20 would require a kernel of 4x4 for fitting it into 5x5 input size</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 725.12px; height: 631.29px;"><img alt="" src="files/rcnn/image2.png" style="width: 725.12px; height: 631.29px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">&nbsp;Figure : RoI Pooling Layer top 2d view with numerical examples bottom 3d view of the same thing</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c4 c16">&nbsp;</span><a id="id.ph21n9qz9a23"></a><span class="c12 c15">Faster RCNN</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6"><span class="c1 c4">Improvements :</span></p><p class="c6"><span class="c1 c0">- The selective search is replaced with a Region Proposal Network that mostly shares weights with the Feature Extractor Network.</span></p><p class="c6"><span class="c1 c0">- The region proposals are further broken down to 3 different scales with 3 different aspect ratios called anchor boxes.</span></p><p class="c6 c9"><span class="c12 c4"></span></p><p class="c6"><span class="c1 c4">The Algorithm:</span></p><p class="c6"><span class="c1 c0">Fater-RCNN can be described as a RPN (Region Proposal Network) and a Fast RCNN. In very short they replaced the Selective search bbox proposal system with RPN network. </span></p><p class="c6"><span class="c4">[A] &nbsp;RPN (Region Proposal Network): </span></p><p class="c6"><span class="c4">Anchor Box : </span><span class="c0">Anchor boxes are prior box estimates at every feature map location. They are determined before the training and fed into the network beforehand. &nbsp;They found 9 anchors from 3 different scales 128x128, 256x256 and 512x512 with 3 aspect ratios 1:1 , 1:2 and 2:1. The prior boxes at every feature map location are further fine tuned by training the RPN model. At every feature map location the prior box coordinate is grid center coordinate for x</span><span class="c0 c8">a</span><span class="c0">&nbsp;and y</span><span class="c0 c8">a</span><span class="c0">; it is common for all the 9 anchors at that location. Nine different w</span><span class="c0 c8">a</span><span class="c0">,h</span><span class="c0 c8">a</span><span class="c0">&nbsp;are found by applying 3 aspect ratio at 3 scales. &nbsp;The RPN model learns how to fit each of the anchor boxes to the object present at that location by predicting offsets t</span><span class="c0 c8">x</span><span class="c0">,t</span><span class="c0 c8">y</span><span class="c0">,t</span><span class="c0 c8">w</span><span class="c0">,t</span><span class="c0 c8">h</span><span class="c1 c0">. At the same time it learns two confidence scores for object and background for each anchor box. &nbsp;More on the anchor boxes will be explained in the anchor box section below.</span></p><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6"><span class="c0">&nbsp;</span><span class="c4">RPN Model : </span><span class="c0">The output of the last shared convolutional layer is passed through a 3x3 convolution layer. For vgg 16 based implementation it should result in an array of shape 40x60x512. Now this array is passed through two sibling 1x1 convolution layers. One layer is for bbox regression and another for class confidence prediction. The bbox regressor has a shape of 40x60x n*k(=36) where n(= 4) &nbsp;represents four [x,y,w,h] &nbsp;coordinates for each anchor and k(=9) represents nine anchor boxes. The confidence predictor output has shape 40x60x n*k(=18) = 40x60x18 where n(=2) for [P</span><span class="c0 c8">obj</span><span class="c0">, P</span><span class="c0 c8">bg</span><span class="c1 c0">], &nbsp;probability of object and background respectively and k=9 as usual. </span></p><p class="c6"><span class="c1 c0">If the output of the RPN has width &lsquo;m&rsquo; and height &lsquo;n&rsquo; the depth would be 2k and 4k for confidence and bbox outputs. A total of m*n*k set of (x,y,w,h) can be extracted from the depthwise 4k data points at each of the m*n locations. Similarly m*n*k set of (object conf,background conf) can be found from 2k data points depthwise. </span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c4">&nbsp;Training RPN :</span><span class="c1 c0">&nbsp;During training they use &ldquo;image-centric&rdquo; sampling. They take all the GT boxes present in one image and compare them with the potential anchor boxes at the feature map locations. Among the total (m*n*k) anchor boxes at every possible location in the featuremap, 2 types of &nbsp;boxes are taken as positive samples. </span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; (i) Boxes with IoU more than 0.7 with any of the GT boxes in the current image, in this way one GT box may produce several positive samples from the anchor boxes. </span></p><p class="c6"><span class="c1 c0">&nbsp; &nbsp; (ii) Boxes having maximum IoU with any of the ground truth boxes are taken as a positive sample as well. </span></p><p class="c6"><span class="c1 c0">The second condition is added due to the possibility that the first condition alone can sometimes fail to get any positive box at all. Boxes with less than 0.3 IoU with all the GT (Ground Truth) boxes are taken as negative samples (background). All other boxes are ignored. Now that we have classified all our anchor boxes to positive or negative it randomly samples 256 boxes by maintaining the positive and negative ratio 1:1 as long as possible. If no of positive samples are lower than 128 in total, they just pad the minibatch with a negative sample to make it 256 in size.</span></p><p class="c6"><span class="c0">They train the RPN model with the following loss function below. Eq1 and Eq2 define t which is the difference between prediction and anchor box. Eq 3 and 4 defines t* which is the difference between anchor box and ground truth. The loss is calculated between t and t* which ultimately minimizes the difference between ground truth and anchor box. The RPN model outputs &lsquo;t&rsquo; from Eq 1 and 2 the value of &nbsp;x, y,w and h can be back calculated from t</span><span class="c0 c8">x</span><span class="c0">,t</span><span class="c0 c8">y</span><span class="c0">,t</span><span class="c0 c8">w</span><span class="c0">,t</span><span class="c0 c8">h</span><span class="c1 c0">&nbsp;predicted from the RPN for prediction.</span></p><p class="c6"><span class="c0">(Notation is consistent with the authors of Faster-RCNN)</span></p><ul class="c17 lst-kix_4rhwz7ggv80b-0 start"><li class="c7 li-bullet-0"><span class="c0">x , x* , x</span><span class="c0 c8">a </span><span class="c1 c0">P prediction, ground truth and anchor respectively.</span></li><li class="c7 li-bullet-0"><span class="c0">p</span><span class="c0 c14">obj</span><span class="c0">,p</span><span class="c0 c14">bg</span><span class="c1 c0">&nbsp;in for object and background confidence.</span></li><li class="c7 li-bullet-0"><span class="c0">&lsquo;t</span><span class="c0 c8">i</span><span class="c0 c1">&rsquo; represents the i(th) bbox (x,y,w,h).</span></li></ul><p class="c11 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c0">t</span><span class="c0 c8">x</span><span class="c0">&nbsp; &nbsp; = (x-x</span><span class="c0 c8">a</span><span class="c0">)/w</span><span class="c0 c8">a</span><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; t</span><span class="c0 c8">y</span><span class="c0">&nbsp;= (y - y</span><span class="c0 c8">a</span><span class="c0">)/h</span><span class="c0 c8">a &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1 c0">&mdash; (1)</span></p><p class="c11"><span class="c0">t</span><span class="c0 c8">w</span><span class="c0">&nbsp; &nbsp;= log(w/w</span><span class="c0 c8">a</span><span class="c0">) &nbsp; &nbsp; &nbsp; &nbsp;; t</span><span class="c0 c8">h</span><span class="c0">&nbsp;= log(h/h</span><span class="c0 c8">a</span><span class="c1 c0">) &nbsp; &nbsp; &nbsp; &nbsp;&mdash; (2)</span></p><p class="c11"><span class="c0">t</span><span class="c0 c8">x* &nbsp; &nbsp;</span><span class="c0">= (x*-x</span><span class="c0 c8">a</span><span class="c0">)/w</span><span class="c0 c8">a</span><span class="c0">&nbsp;, &nbsp; &nbsp; ; t</span><span class="c0 c8">y</span><span class="c0">&nbsp;= (y* - y</span><span class="c0 c8">a</span><span class="c0">)/h</span><span class="c0 c8">a &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">&mdash; (3)</span></p><p class="c11"><span class="c0">t</span><span class="c0 c8">w*</span><span class="c0">&nbsp; = log(w*/w</span><span class="c0 c8">a</span><span class="c0">) &nbsp; &nbsp; ; t</span><span class="c0 c8">h</span><span class="c0">&nbsp;= log(h*/h</span><span class="c0 c8">a</span><span class="c0">) &nbsp; &nbsp; &nbsp;</span><span class="c0 c8">&nbsp;</span><span class="c1 c0">&mdash; (4)</span></p><p class="c11 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c0">L</span><span class="c0 c8">&nbsp;</span><span class="c0">&nbsp;= &lambda; x &nbsp;1/</span><span class="c0">N</span><span class="c0 c8">reg</span><span class="c0 c8">&nbsp; </span><span class="c0">x &nbsp;</span><span class="c0 c18">&Sigma;</span><span class="c0 c26 c14">N</span><span class="c0 c8 c26">i</span><span class="c0">&nbsp; &nbsp; [ </span><span class="c0">p</span><span class="c0 c8">i</span><span class="c0 c14">obj</span><span class="c0">&nbsp;x</span><span class="c0">&nbsp;</span><span class="c0">L</span><span class="c0 c8">reg(i)</span><span class="c0">&nbsp;(t</span><span class="c0 c8">i</span><span class="c0">, t</span><span class="c0 c8">i*</span><span class="c0">) + &nbsp;Robust L</span><span class="c0 c8">1</span><span class="c0">&nbsp;(t</span><span class="c0 c8">i</span><span class="c0">, t</span><span class="c0 c8">i*</span><span class="c1 c0">)] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Robust L1 Smoothing introduced in Fast RCNN)</span></p><p class="c11"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; + &nbsp; &nbsp;1/</span><span class="c0">N</span><span class="c0 c8">cls</span><span class="c0">&nbsp;x </span><span class="c0 c18">&Sigma;</span><span class="c0 c26 c14">N</span><span class="c0 c8 c26">i </span><span class="c0">&nbsp; &nbsp; [ </span><span class="c0 c14">&nbsp;</span><span class="c0">L</span><span class="c0 c8">cls</span><span class="c0">&nbsp;(p</span><span class="c0 c14">obj</span><span class="c0 c8">i</span><span class="c0 c14">*</span><span class="c0">,p</span><span class="c0 c14">bg</span><span class="c0 c8">i</span><span class="c0 c14">*</span><span class="c0">)]</span><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(e.g binary cross entropy loss can be used as L</span><span class="c0 c8">cls</span><span class="c1 c0">)</span></p><p class="c11 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c0">here </span><span class="c0">N</span><span class="c0 c8">cls</span><span class="c0">&nbsp;= 256 ; </span><span class="c0">N</span><span class="c0 c8">reg</span><span class="c1 c0">&nbsp;= 2400 ; &nbsp;Lambda = 10 </span></p><p class="c11"><span class="c0">Total Loss = &nbsp;L</span><span class="c0 c8">cls</span><span class="c0">&nbsp;+ </span><span class="c0">L</span><span class="c0 c8 c22">reg</span></p><p class="c11 c9"><span class="c22 c0 c8"></span></p><p class="c6"><span class="c1 c0">They do bbox and confidence prediction at every fmap location respectively. The 1x1 convolution layer can also be interpreted as a dense layer applied at every pixel location and results in an array with the same height and width while having depth of 4k and 2k respectively, k= number of anchor boxes per location. Region Proposal Network proposes possible box coordinates and objectness confidence at each pixel location of the feature map. This is a class agnostic box predictor so it has nothing to do with the category of the object. The output of the RPN module is converted to bbox coordinates at every feature map location .</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 864.30px; height: 762.84px;"><img alt="" src="files/rcnn/image12.png" style="width: 864.30px; height: 762.84px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">Figure : Faster RCNN</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c12 c4">Anchor Box / Multi Box / Default Box</span></p><p class="c6"><span class="c4">Translation Invariance : </span><span class="c0">Anchor boxes were first used by erhan at el. , szegedy at el in their respective works. It is referred to as the multibox approach or default box in other works. &nbsp;</span><span class="c27">Initial anchor box methods used different anchors (prior boxes) at different locations of the image resulting in a lot of unique anchors. For example, the multibox method by szegedy at el. was not translation invariant. It used 800 anchor boxes at different locations of the image. They found this 800 anchors by k means clustering o</span><span class="c1 c0">f the [x,y,w,h] of all the Ground truth bboxes. In contrast, faster rcnn does k means clustering for h,w only irrespective of their x,y location in image. These 9 boxes can just fit any arbitrary x,y location in the image instead of 800 different boxes for various x,y locations. They conducted some experiments with different values of k and found k=9 anchor boxes are optimal for achieving the best mAP. &nbsp;This 9 boxes are now capable of producing w*h*9 ~ 2400 x 9 RoI per image at maximum.</span></p><p class="c6"><span class="c1 c0">&nbsp;-&gt; For Multibox the shape of tensor for RoI prediction was 4+1* 800 dimensional &nbsp;fully connected layer</span></p><p class="c6"><span class="c1 c0">&nbsp;-&gt; &nbsp;For Faster RCNN it reduced to 4+2*9 convolutional output layer.</span></p><p class="c6"><span class="c4">Multiple objects at one location :</span><span class="c1 c0">&nbsp;At each pixel location we can get k=9 boxes and respective confidence scores. It will make it possible to detect multiple objects centered at the same image location (having different aspect ratio or scale). </span></p><p class="c6"><span class="c4">Multi scale at low parameters :</span><span class="c1 c0">&nbsp;It makes the model learn multiple scales of objects without using additional branches from the backbone network like SSD or FPN. So it can have multiple scales with minimum possible cost of parameters.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 637.50px; height: 310.45px;"><img alt="" src="files/rcnn/image11.png" style="width: 637.50px; height: 310.45px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&nbsp; &nbsp;Image from Faster RCNN paper Ren et al 2016</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 488.50px; height: 406.64px;"><img alt="" src="files/rcnn/image4.png" style="width: 488.50px; height: 406.64px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Figure : &nbsp;Total 9 anchor boxes at one pixel locations</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">The feature extractor and classifier is the same as Fast RCNN.</span></p><p class="c6"><span class="c1 c4">[B] Feature Extractor :</span></p><p class="c6"><span class="c1 c0">&nbsp;- It primarily uses the VGG16 network feature extractor which shares its weights with the RPN (until the RPN specific layers). It used the VGG16 and also ZF [zeiler at el.] pre-trained on ImageNet dataset for demonstrating their algorithm performance.</span></p><p class="c6"><span class="c1 c0">&nbsp;- The last max pool layer is replaced with a RoI Pooling layer for extracting fixed sized feature maps for every Fmap RoI so that it can fit into the first dense layer (H=7, W=7 for VGG 16) </span></p><p class="c6"><span class="c1 c0">&nbsp;- RoI pooling layer projects the RoI coordinates on top of the feature map array in a max pooling manner, the difference here is it adjusts the pooling window size for keeping the output size fixed for all the fmap. RoIs.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c4">[C] Classifier :</span><span class="c1 c0">&nbsp;Each of the output (fmap RoIs) from the RoI Pooling layer is sent to a small dense network ending with 2 sibling dense layers (i) one for classification (ii) another for bbox regression. The regressor here </span></p><p class="c6"><span class="c1 c0">learns the x,y offset and log offset for w and h from the prior boxes predicted by RPN initially.</span></p><p class="c11 c9"><span class="c1 c0"></span></p><p class="c11"><span class="c1 c4">Back propagation :</span></p><p class="c11"><span class="c4">(1) Alternate training :</span><span class="c1 c0">&nbsp;(Used by the authors)</span></p><p class="c11"><span class="c1 c0">RPN and Fast-RCNN share the same network (the &quot;Shared CNN Layers&quot; part in above figure). Rest of the layers are task specific i.e RPN Layers and Dense Layers at the end. Both of the networks are initialized with imagenet pre-trained weights for either VGG-16 (first 13 CNN layers) or ZF network (first 5 CNN layers) &nbsp;[zeiler at el.]. *Fast-RCNN is a special case of Fast-RCNN, &nbsp;that will be trained with region proposals from RPN predictions instead of selective search. </span></p><p class="c11"><span class="c1 c0">- First the RPN is trained. </span></p><p class="c11"><span class="c1 c0">- Then using the region proposal results of RPN is used as input for training the *Fast-RCNN.</span></p><p class="c11"><span class="c1 c0">- Next RPN is initialized with the Fast-RCNN weights (only the shared part) and trained again for the RPN specific layers at the bottom are trained only keeping the shared layers fixed.</span></p><p class="c11"><span class="c1 c0">- Finally, both the *Fast-RCNN is trained again keeping the common layers fixed.</span></p><p class="c11"><span class="c4">(2) Approximate Joint training :</span><span class="c1 c0">&nbsp;Using the same network for RPN and Fast-RCNN* from the beginning. Training them together. For Fast-RCNN the outputs from RPN during forward pass are taken as input assuming them fixed predefined values. Since the RoI pooling layer is not differentiable that&#39;s why they needed to consider the outputs of RPN fixed values.</span></p><p class="c11"><span class="c4">(3) Non Approximate Joint training :</span><span class="c1 c0">&nbsp;In this method they proposed using a differentiable RoI Pooling layer where so that the outputs taken from RoI pooling and fed back to the Fast-RCNN would be a part of the back propagation chain</span></p><p class="c11"><span class="c1 c0">Authors showed their results with method (1) in the paper.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><a id="id.5vr554v50nm8"></a><p class="c6"><span class="c1 c13">Mask RCNN</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6"><span class="c1 c4">Improvements in Mask RCNN :</span></p><p class="c6"><span class="c1 c0">- RoI Pooling layer is replaced with RoI align layers.</span></p><p class="c6"><span class="c1 c0">- Additional semantic segmentation branch is added for predicting both bbox and segmentation at a time. I will refer it as [D]</span></p><p class="c6 c9"><span class="c4 c29 c19"></span></p><p class="c6"><span class="c1 c4">The Algorithm Mask RCNN:</span></p><p class="c6"><span class="c1 c0">The algorithm is very similar to faster rcnn. The major difference here is that they used a more accurate version of the RoI Pooling layer. They also added a segmentation branch to the original network and was able to produce accurate semantic segmentation along with bounding box prediction.</span></p><p class="c6"><span class="c1 c0">&nbsp;</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c4">Mask RCNN Loss</span></p><p class="c6"><span class="c0">Loss = L</span><span class="c0 c8">cls</span><span class="c0">&nbsp;+ L</span><span class="c0 c8">bbox </span><span class="c0">+ L</span><span class="c22 c0 c8">seg</span></p><p class="c6"><span class="c0">L</span><span class="c0 c8">cls</span><span class="c0">&nbsp;and L</span><span class="c0 c8">reg</span><span class="c1 c0">&nbsp;are similar to Faster RCNN.</span></p><p class="c6"><span class="c0">L</span><span class="c0 c8">seg = </span><span class="c0">1/N x </span><span class="c0 c18">&Sigma;</span><span class="c0 c18 c14">N</span><span class="c0 c18 c8">i</span><span class="c0">&nbsp;[</span><span class="c0 c18">&Sigma;</span><span class="c0 c8 c26">jk </span><span class="c0">-y</span><span class="c0 c14">jk</span><span class="c0 c8">i</span><span class="c0 c14">*</span><span class="c0">log(y</span><span class="c0 c14">jk</span><span class="c0 c8">i</span><span class="c1 c0">) ] , j and k are pixel locations in horizontal and vertical axes.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 819.16px; height: 509.97px;"><img alt="" src="files/rcnn/image5.png" style="width: 819.16px; height: 509.97px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Figure : Mask RCNN Algorithm</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 591.70px; height: 303.94px;"><img alt="" src="files/rcnn/image7.png" style="width: 591.70px; height: 303.94px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Figure : RoI Align Layer</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">RoI Align layer does the same job of RoI pooling but little accurately using a different approach.</span></p><p class="c6"><span class="c1 c0">[1] RoI Scaling : It does not round up the floating point number while scaling down the RoI sizes to match the feature map dimension/</span></p><p class="c6"><span class="c1 c0">[2] Resizing : It uses bilinear interpolation for converting the floating window size to a fixed window input size i.e 5x5 here.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c15">Summary</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">RCNN </span></p><p class="c6"><span class="c1 c0">&nbsp;[A] Selective Search &nbsp;</span></p><p class="c6"><span class="c1 c0">&nbsp;[B] 1 by 1 FE </span></p><p class="c6"><span class="c1 c0">&nbsp;[C] 1 by 1 classification by separate binary SVM for each class</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Fast RCNN </span></p><p class="c6"><span class="c1 c0">&nbsp;[A] Selective Search</span></p><p class="c6"><span class="c1 c0">&nbsp;[B] Single pass Feature Extractor + 1x1 RoI Pooling</span></p><p class="c6"><span class="c1 c0">&nbsp;[C] 1x1 fmap through dense layer and softmax </span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Faster RCNN</span></p><p class="c6"><span class="c1 c0">&nbsp;[A] RPN + Anchor box</span></p><p class="c6"><span class="c1 c0">&nbsp;[B] Single pass Feature Extractor + 1x1 RoI Pooling</span></p><p class="c6"><span class="c1 c0">&nbsp;[C] 1x1 fmap through dense layer and softmax </span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Mask RCNN </span></p><p class="c6"><span class="c1 c0">&nbsp;[A] RPN + Anchor Box</span></p><p class="c6"><span class="c1 c0">&nbsp;[B] Single pass Feature Extractor + 1x1 RoI Align</span></p><p class="c6"><span class="c1 c0">&nbsp;[C] 1x1 fmap through dense layer and softmax </span></p><p class="c6"><span class="c1 c0">&nbsp;[D] Segmentation Branch</span></p><p class="c6 c9"><span class="c1 c0"></span></p><a id="id.ux9wfpfe9xxw"></a><p class="c6"><span class="c15 c16">Symbols and Short forms</span></p><hr><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 792.79px; height: 324.78px;"><img alt="" src="files/rcnn/image10.png" style="width: 792.79px; height: 324.78px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">Below are some short forms that will be used in the later sections of this chapter : </span></p><p class="c6"><span class="c1 c0">RoI &nbsp; &nbsp;: Region of Interest. Small cropped section of an image.</span></p><p class="c6"><span class="c1 c0">Fmap /feat map : Feature Map. &nbsp;Truncated 3-dimensional output of a CNN based network from any layer at the middle. It represents the learnt features upto that layer.</span></p><p class="c6"><span class="c1 c0">FE &nbsp; &nbsp; : Feature Extractor. It will represent a deep learning model that extracts features from input data. The term &lsquo;FE&rsquo; will be used synonymously with any deep neural network architecture. e.g VGG16 which exactly does the same.</span></p><p class="c6"><span class="c1 c0">FC &nbsp; &nbsp; : Fully Connected Dense Layer/Layers.</span></p><p class="c6"><span class="c1 c0">bbox &nbsp;: Bounding box. [i.e box coordinates x,y,w,h]</span></p><p class="c6"><span class="c1 c0">GT &nbsp; &nbsp; : Ground Truth</span></p><p class="c6"><span class="c1 c0">CNN &nbsp;: Convolutional Neural Network. ; </span></p><p class="c6"><span class="c0">Conv</span><span class="c1 c0">. : Convolutional.</span></p><p class="c6"><span class="c1 c0">For explainability of the figures I have used consistent symbols while drawing part of the model. &nbsp;The symbols and references are defined at the end.</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><a id="id.5wa040rdg73v"></a><p class="c6"><span class="c12 c15">Appendix :</span></p><hr><p class="c6 c9"><span class="c4 c12"></span></p><p class="c9 c25"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Selective search &nbsp;</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c0">Quote from Uijlings et al 2013 - &quot;Our grouping procedure now works as follows. We first</span></p><p class="c6"><span class="c1 c0">use (Felzenszwalb and Huttenlocher 2004) to create initial regions. Then we use a greedy algorithm to iteratively group regions together: First the similarities between all neighbour- ing regions are calculated. The two most similar regions are grouped together, and new similarities are calculated between the resulting region and its neighbours. The process ofgroup- ing the most similar regions is repeated until the whole image becomes a single region&quot;</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 519.50px; height: 360.45px;"><img alt="" src="files/rcnn/image8.png" style="width: 519.50px; height: 360.45px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Image from the selective search paper by &nbsp;Uijlings et al 2013</span></p><p class="c6 c9"><span class="c2"></span></p><p class="c6 c9"><span class="c2"></span></p><p class="c6"><span class="c0">Relevance</span><span class="c1 c0">&nbsp;between the above explanation and the authors figure in the respective papers. The steps [A],[B], [C] and [D] are shown below for better correlating with the above content, while reading from the paper.</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 574.50px; height: 540.29px;"><img alt="" src="files/rcnn/image9.png" style="width: 574.50px; height: 540.29px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c2">(i) Top : Image from RCNN paper by Girshick et al. 2014. (ii) Bottom : Image from Fast RCNN paper by Girshick et al. 2015</span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 342.50px; height: 349.19px;"><img alt="" src="files/rcnn/image1.png" style="width: 342.50px; height: 349.19px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 411.50px; height: 223.90px;"><img alt="" src="files/rcnn/image3.png" style="width: 411.50px; height: 223.90px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c9"><span class="c2"></span></p><p class="c6"><span class="c2">&nbsp;Left : Image from Faster RCNN paper Ren et al 2016 , Right : Image from Mask RCNN from He et al </span></p><p class="c6 c9"><span class="c2"></span></p><p class="c6 c9"><span class="c2"></span></p><p class="c6 c9"><span class="c2"></span></p><a id="id.yjsz3yu24x1v"></a><p class="c6"><span class="c15">References :</span></p><hr><p class="c6 c9"><span class="c2"></span></p><p class="c6 c9"><span class="c1 c4"></span></p><p class="c6"><span class="c4">GitHub Repositories:</span></p><ol class="c17 lst-kix_eg1j27aju83u-0 start" start="1"><li class="c6 c20 li-bullet-0"><span class="c10 c0 c16"><a class="c3" href="https://www.google.com/url?q=https://github.com/facebookresearch/Detectron&amp;sa=D&amp;source=editors&amp;ust=1667733638595761&amp;usg=AOvVaw2MyB80s5wB7Nsu8cZgtLtk">https://github.com/facebookresearch/Detectron</a></span></li><li class="c6 c20 li-bullet-0"><span class="c10 c0 c16"><a class="c3" href="https://www.google.com/url?q=https://github.com/matterport/Mask_RCNN&amp;sa=D&amp;source=editors&amp;ust=1667733638596244&amp;usg=AOvVaw15alKUnRI9KqiTGmEFAwWe">https://github.com/matterport/Mask_RCNN</a></span></li></ol><p class="c6 c9 c28"><span class="c1 c4"></span></p><p class="c6"><span class="c1 c4">Models :</span></p><p class="c6"><span class="c1 c0">1. ImageNet Classification with Deep Convolutional</span></p><p class="c6"><span class="c0">Neural Networks : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://proceedings.neurips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf&amp;sa=D&amp;source=editors&amp;ust=1667733638596915&amp;usg=AOvVaw3u4LTTy7fXadPIjD5fKd-Y">https://proceedings.neurips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf</a></span><span class="c1 c0">&nbsp; &nbsp;</span></p><p class="c6"><span class="c0">2. Very Deep Convolutional Networks For Large-Scale Image Recognition: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/pdf/1409.1556.pdf&amp;sa=D&amp;source=editors&amp;ust=1667733638597284&amp;usg=AOvVaw1IS8bM6TZUChMQP5tdw-Dv">https://arxiv.org/pdf/1409.1556.pdf</a></span></p><p class="c6"><span class="c0">3. Visualizing and understanding convolutional neural networks :</span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/pdf/1311.2901.pdf&amp;sa=D&amp;source=editors&amp;ust=1667733638597642&amp;usg=AOvVaw3PT1V5tSsSZgRIvrYwVtUn">https://arxiv.org/pdf/1311.2901.pdf</a></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Region Proposal Generation :</span></p><p class="c6"><span class="c0">4. Selective search : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://link.springer.com/article/10.1007/s11263-013-0620-5&amp;sa=D&amp;source=editors&amp;ust=1667733638598168&amp;usg=AOvVaw1Ro5vFcVcGObjOrUZTvhir">https://link.springer.com/article/10.1007/s11263-013-0620-5</a></span></p><p class="c6"><span class="c0">5. Objectness &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="c0 c10"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/2004.02945&amp;sa=D&amp;source=editors&amp;ust=1667733638598520&amp;usg=AOvVaw22rLDzM0ifi8aT91CKriBH">https://arxiv.org/abs/2004.02945</a></span></p><p class="c6"><span class="c1 c0">Object Detection</span></p><p class="c6"><span class="c0">6. SPP-Net: Deep Absolute Pose Regression with Synthetic Views : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1406.4729&amp;sa=D&amp;source=editors&amp;ust=1667733638598951&amp;usg=AOvVaw1OD9gYs-5xhoiO3uDTJeUB">https://arxiv.org/abs/1406.4729</a></span></p><p class="c6"><span class="c0">7. OverFeat: Integrated Recognition, Localization and Detection using Convolutional Networks : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1312.6229&amp;sa=D&amp;source=editors&amp;ust=1667733638599309&amp;usg=AOvVaw15ldc4PeENwcv7aiFVMjW3">https://arxiv.org/abs/1312.6229</a></span></p><p class="c6"><span class="c0">8. Deformable Part Models are Convolutional Neural Networks : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/pdf/1409.5403&amp;sa=D&amp;source=editors&amp;ust=1667733638599646&amp;usg=AOvVaw2pn1FKkBlR9FEJf7VETHys">https://arxiv.org/pdf/1409.5403</a></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c0">9. R-CNN: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1311.2524&amp;sa=D&amp;source=editors&amp;ust=1667733638600061&amp;usg=AOvVaw1um2_gALDuK3GW3j5s-q78">https://arxiv.org/abs/1311.2524</a></span></p><p class="c6"><span class="c0">10. Fast R-CNN: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1504.08083&amp;sa=D&amp;source=editors&amp;ust=1667733638600486&amp;usg=AOvVaw3VxMYs-JP3eu-5yiLWN6cR">https://arxiv.org/abs/1504.08083</a></span></p><p class="c6"><span class="c0">11 Faster R-CNN: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1506.01497&amp;sa=D&amp;source=editors&amp;ust=1667733638600826&amp;usg=AOvVaw1TQzRMp-GTid6c58XTqqLW">https://arxiv.org/abs/1506.01497</a></span></p><p class="c6"><span class="c0">12. Mask R-CNN: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1703.06870&amp;sa=D&amp;source=editors&amp;ust=1667733638601148&amp;usg=AOvVaw1SwPZaJQEIdCzbCmenOchd">https://arxiv.org/abs/1703.06870</a></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Multibox Approaches :</span></p><p class="c6"><span class="c0">13. Scalable object detection using deep neural networks : </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1312.2249&amp;sa=D&amp;source=editors&amp;ust=1667733638601657&amp;usg=AOvVaw1Sqbe9HjGBR9kv3kGrgEfx">https://arxiv.org/abs/1312.2249</a></span></p><p class="c6"><span class="c0">14. Scalable, high-quality object detection &nbsp;: </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://arxiv.org/abs/1412.1441&amp;sa=D&amp;source=editors&amp;ust=1667733638601992&amp;usg=AOvVaw15KQuDjBNlTcn7XPoBsHk6">https://arxiv.org/abs/1412.1441</a></span></p><p class="c6 c9"><span class="c1 c0"></span></p><p class="c6"><span class="c1 c4">Blogs :</span></p><p class="c6"><span class="c1 c0">Special thanks to for easy such a nice explanation of important things -</span></p><p class="c6"><span class="c0">1. </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://lilianweng.github.io/posts/2017-12-31-object-recognition-part-3/&amp;sa=D&amp;source=editors&amp;ust=1667733638602618&amp;usg=AOvVaw0OfCcoh0LPuMdIU2tLgHLr">https://lilianweng.github.io/posts/2017-12-31-object-recognition-part-3/</a></span></p><p class="c6"><span class="c0">2. </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://towardsdatascience.com/faster-r-cnn-for-object-detection-a-technical-summary-474c5b857b46&amp;sa=D&amp;source=editors&amp;ust=1667733638603047&amp;usg=AOvVaw2yzBldX5BzkejqMgPaBdEC">https://towardsdatascience.com/faster-r-cnn-for-object-detection-a-technical-summary-474c5b857b46</a></span></p><p class="c6"><span class="c0">3. </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://blog.athelas.com/a-brief-history-of-cnns-in-image-segmentation-from-r-cnn-to-mask-r-cnn-34ea83205de4&amp;sa=D&amp;source=editors&amp;ust=1667733638603676&amp;usg=AOvVaw26a3U4EptqXTRIdwVpEEQF">https://blog.athelas.com/a-brief-history-of-cnns-in-image-segmentation-from-r-cnn-to-mask-r-cnn-34ea83205de4</a></span></p><p class="c6"><span class="c0">4. </span><span class="c10 c0"><a class="c3" href="https://www.google.com/url?q=https://jonathan-hui.medium.com/image-segmentation-with-mask-r-cnn-ebe6d793272&amp;sa=D&amp;source=editors&amp;ust=1667733638604197&amp;usg=AOvVaw1rFlSRfEeYbDjhBNwhygxe">https://jonathan-hui.medium.com/image-segmentation-with-mask-r-cnn-ebe6d793272</a></span></p><p class="c6 c9"><span class="c2"></span></p></body></html>